"use strict";(self.webpackChunksource_2_wiki=self.webpackChunksource_2_wiki||[]).push([["15298"],{38275(e,i,t){t.r(i),t.d(i,{metadata:()=>n,default:()=>h,frontMatter:()=>l,contentTitle:()=>r,toc:()=>d,assets:()=>a});var n=JSON.parse('{"id":"EngineTools/HammerEditor/visibility","title":"Visibility","description":"Also known as \\"VIS\\", visibility is a vital part of map optimization as it determines what should and shouldn\'t be rendered.","source":"@site/docs/EngineTools/HammerEditor/visibility.md","sourceDirName":"EngineTools/HammerEditor","slug":"/EngineTools/HammerEditor/visibility","permalink":"/EngineTools/HammerEditor/visibility","draft":false,"unlisted":false,"editUrl":"https://github.com/Source2Wiki/Source2Wiki/blob/master/docs/EngineTools/HammerEditor/visibility.md?plain=1","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Level Design","permalink":"/EngineTools/HammerEditor/level-design"},"next":{"title":"Material Editor","permalink":"/EngineTools/MaterialEditor/"}}'),s=t(74848),o=t(28453);let l={},r="Visibility",a={},d=[{value:"Leaks",id:"leaks",level:2},{value:"VIS Contributors",id:"vis-contributors",level:2},{value:"Tool textures that contribute to VIS",id:"tool-textures-that-contribute-to-vis",level:3},{value:"Debugging VIS",id:"debugging-vis",level:2},{value:"VIS in Hammer",id:"vis-in-hammer",level:2},{value:"Best practices &amp; Common Mistakes",id:"best-practices--common-mistakes",level:2},{value:"Helpful VIS entities",id:"helpful-vis-entities",level:2},{value:"visibility_hint",id:"visibility_hint",level:3},{value:"info_cull_triangles",id:"info_cull_triangles",level:3},{value:"VIS2 vs. VIS3",id:"vis2-vs-vis3",level:2}];function c(e){let i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components},{Game:n}=i;return n||function(e,i){throw Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Game",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"visibility",children:"Visibility"})}),"\n",(0,s.jsx)(i.p,{children:'Also known as "VIS", visibility is a vital part of map optimization as it determines what should and shouldn\'t be rendered.'}),"\n",(0,s.jsx)(i.admonition,{type:"note",children:(0,s.jsx)(i.p,{children:'Precomputed visibility costs map compile time. For rapid iteration and development, you can turn off VIS compilation by setting the "Precomputed Visibility" property in "Map Properties" to "Disabled."'})}),"\n",(0,s.jsx)(i.p,{children:'In Source 2, the resource compiler uses an inside/outside algorithm to calculate VIS and determine which areas are "inside" the map. This means that anything inside will render, and anything outside won\'t.'}),"\n",(0,s.jsx)(i.h2,{id:"leaks",children:"Leaks"}),"\n",(0,s.jsx)(i.p,{children:'Although Source 2 doesn\'t leak in the same way that Source 1 did, VIS can still leak through "holes" in your map. This means that the VIS calculation will spill out into the void, creating unnecessary VIS clusters and LOS. Typically, this means forgetting to place a skybox material or solid blocklight, leaving a gap in world geometry.'}),"\n",(0,s.jsx)(i.h2,{id:"vis-contributors",children:"VIS Contributors"}),"\n",(0,s.jsx)(i.p,{children:'By default, all meshes are VIS contributors, which can be disabled by selecting "Exclude from VIS". Static props are the inverse, and you can set them as VIS contributors by marking the "Vis Occluder" property.'}),"\n",(0,s.jsx)(i.h3,{id:"tool-textures-that-contribute-to-vis",children:"Tool textures that contribute to VIS"}),"\n",(0,s.jsx)(i.p,{children:"Some tools materials contribute to your map's VIS. These include:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"visblocker"}),"\n",(0,s.jsx)(i.li,{children:"toolsskybox"}),"\n",(0,s.jsx)(i.li,{children:"toolsnodraw (all variations)"}),"\n",(0,s.jsx)(i.li,{children:"toolssolidblocklight"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"debugging-vis",children:"Debugging VIS"}),"\n",(0,s.jsx)(i.p,{children:"There are a few console commands that can help debug the compiled VIS in your map."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"vis_enable"})," 0/1		|		Toggle the visibility system."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"sc_no_vis"})," 0/1     | Similar behavior to vis_enable; toggles VIS"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"sc_aggregate_gpu_culling"})," 0/1 | In ",(0,s.jsx)(n,{name:"cs2"}),", toggles GPU culling"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"vis_debug_show"}),'		|		This will show the compiled VIS clusters in your map; it\'s an in-game representation of "Load Compiled Vis Data" in Hammer']}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"vis_debug_lock"}),"		|		Locks the VIS to the current state when you sent the command.","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"sc_no_vis"})," and ",(0,s.jsx)(i.code,{children:"sc_aggregate_gpu_culling"})," can be seen in ",(0,s.jsx)(n,{name:"cs2"}),"'s VConsole Convar helper, under the performance section with labels ",(0,s.jsx)(i.code,{children:"Toggle VIS OFF/ON"})," and ",(0,s.jsx)(i.code,{children:"Toggle GPU Culling"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"vis-in-hammer",children:"VIS in Hammer"}),"\n",(0,s.jsx)(i.p,{children:'Use the Visibility contributors view to toggle geometry that doesn\'t contribute to VIS. This view is very helpful for spotting leaks, alongside the "Load Compiled Vis Data" option.'}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"visibility-contributors-view",src:t(47628).A+"",title:"Visibility Contributors View",width:"316",height:"173"})}),"\n",(0,s.jsx)(i.h2,{id:"best-practices--common-mistakes",children:"Best practices & Common Mistakes"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:['As noted before, VIS can "leak". To avoid this, seal all level geometry',"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Try not to have any VIS contributors poke out of your map, as this can have similar behavior to leaks."}),"\n",(0,s.jsx)(i.li,{children:"Don't place VIS contributors outside of your map. If you want it to be part of your skybox, consider using a 3D Skybox instead."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.li,{children:"Do not use SkyVisBlocker as it's deprecated. Using toolsskybox instead."}),"\n",(0,s.jsx)(i.li,{children:"Be careful with Solid Blocklight, as it is a VIS contributor. Any outward-facing Solid Blocklight could create VIS clusters on the outside of your map."}),"\n",(0,s.jsx)(i.li,{children:"If developing for a game that uses VIS2, try to keep as many VIS contributors aligned to grid as possible (aligning things to grid is a good practice in general, too). To see the differences between VIS2 and VIS3, see further down."}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"helpful-vis-entities",children:"Helpful VIS entities"}),"\n",(0,s.jsx)(i.h3,{id:"visibility_hint",children:"visibility_hint"}),"\n",(0,s.jsx)(i.p,{children:"Visibility hint is an entity that lets you control the resolution of the VIS clusters generated within its volume. This can be very beneficial for large open maps that don't have many objects that could block line of sight. Fewer VIS clusters in these areas could allow more to be generated where they're needed more."}),"\n",(0,s.jsx)(i.h3,{id:"info_cull_triangles",children:"info_cull_triangles"}),"\n",(0,s.jsx)(i.p,{children:"info_cull_triangles will remove any triangles that are within its bounds and pass its filters during compile time, which can be especially useful for culling parts of props or geometry that extend outside of level bounds. You may remember that objects poking through your map can cause VIS to misbehave; logic_cull_triangles can potentially help by removing the offending triangles extending outside of your map bounds."}),"\n",(0,s.jsx)(i.h2,{id:"vis2-vs-vis3",children:"VIS2 vs. VIS3"}),"\n",(0,s.jsxs)(i.p,{children:["Older versions of Source 2, like ",(0,s.jsx)(n,{name:"hla"})," and ",(0,s.jsx)(n,{name:"steamvr"})," use VIS2, whereas newer versions like ",(0,s.jsx)(n,{name:"cs2"})," use VIS3.\nNotable differences between them are:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"VIS3 handles VIS contributors that are not aligned to grid much better than VIS2"}),"\n",(0,s.jsx)(i.li,{children:"VIS3 compiles meshlets, which are meshes split into 128 triangle chunks that get culled on the GPU"}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{type:"todo",children:(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"note any further disparity between VIS2 and VIS3"}),"\n",(0,s.jsx)(i.li,{children:"add more accompanying pictures"}),"\n"]})})]})}function h(e={}){let{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},47628(e,i,t){t.d(i,{A:()=>n});let n=t.p+"assets/images/vis_contrib_view-262d7701f07ad12c6d44d4bbfc269f35.png"},28453(e,i,t){t.d(i,{R:()=>l,x:()=>r});var n=t(96540);let s={},o=n.createContext(s);function l(e){let i=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);